---
layout: page
title: "Emulated sensor"
category: doc
date: 2016-06-27 12:00:00
---
# 2. Emulated Sensor
## 2.1. Introduction
Emulated Sensor mô ph?ng ho?t d?ng c?a các sensor th?c, bao g?m 3 bu?c. 

Bu?c 1, sensor thu nh?n d? li?u t? môi tru?ng, ví d? nhi?t d?, d? ?m, thông s? thi?t b?. Các d? li?u thu th?p thu?ng ? các d?nh d?ng khác nhau, ví d? tên tru?ng, ki?u d? li?u (cùng là nhi?t d?, d? li?u có th? là C ho?c F, tên tru?ng là temperature, temp) . 

Bu?c 2, sensor chuy?n d?i d? li?u d?c trung c?a môi tru?ng thành d?nh d?ng chu?n.

Bu?c 3, sensor g?i d? li?u d?n các platform ho?c d?u ra khác. Bu?c này c?n s? chuy?n d?i d? li?u t? d?nh d?ng chu?n sang d?nh d?ng d?u ra phù h?p.
## 2.2. Architecture

**Data ---(InputAdaptor) ---> Emulated Sensor ----(OutputAdaptor)---> Providers
					T
					I
				  sensor.conf**

	Data:d? li?u th?c du?c thu th?p t? sensor th?c v?i các d?nh d?ng khác nhau.
Input Adaptor: có nhi?m v? chuy?n t? d? li?u sensor th?c t? các d?nh d?ng khác nhau thành 1 d?nh d?ng duy nh?t. D? li?u chu?n này này có d?ng: Map<String,String>
OutputAdaptor: Có nhi?m v? chuy?n t? d? li?u d?u ra duy nh?t c?a Emulated Sensor thành d? li?u theo d?nh d?ng ?ng v?i t?ng provider c? th?.

Vi?c l?a ch?n ki?u d? li?u d?u vào và provider du?c c?u hình trong 1 file configure có tên là “Sensor.conf”. C?u trúc c?a file sensor.conf bao g?m:
*C?u hình cho Emulated Sensor
*C?u hình cho Input: 
*C?u hình cho Output: 

## 2.3. Input adaptor
### 2.3.1. CSV Adaptor
Ð?u vào co b?n nh?t c?a Emulated Sensor là các file CSV. M?c dích c?a vi?c dùng file CSV là mô ph?ng l?i m?t k?ch b?n dã có. Ví d?, ngu?i dùng c?n mô ph?ng l?i nhi?t d? c?a phòng trong m?t ngày, d? li?u này dã du?c ghi l?i (log) trong file CSV.
CSV là m?t file text có c?u trúc nhu sau:
Dòng d?u tiên ch?a tên các tru?ng (header)
Các dòng ti?p theo luu tr? các b?n ghi d? li?u (record), m?i b?n ghi 1 dòng
Các c?t d? li?u phân cách nhau b?ng d?u ph?y
M?c d?nh Emulated Sensor s? d?c file “sensor.data” t?i thu m?c hi?n th?i
CSV Adaptor s? d?c dòng d?u tiên d? l?y ra tên các c?t d? li?u. Sau m?i chu k?, sensor d?c 1 dòng ti?p theo trong file CSV. Các c?t d? li?u trong b?n ghi du?c gán tuong ?ng v?i tên các tru?ng trong header.



Ví d?: file csv tên là “sensor.data”

timestamp,cpu,ram,computername
20052016,1.3,500,TRANGPC    
20052016,1.5,600,TRANGPC   
20052016,1.6,800,TRANGPC
20052016,1.4,900,TRANGPC   
20052016,1.3,100,TRANGPC   
20052016,1.2,200,TRANGPC
20052016,1.6,300,TRANGPC
20052016,1.9,400,TRANGPC

Sau m?i chu k?, d? li?u du?c d?y ra du?i d?ng Map nhu sau:
{timestamp=20052016, ram=600, cpu=1.5, computername=TRANGPC, sensorid=123}

### 2.3.2. ConsoleData adaptor
User có th? nh?p d? li?u tr?c ti?p t? bàn phím 
### 2.3.3. Laptop data adaptor
D? li?u c?a user, c? th? ph?n này là d? li?u l?y t? sensor c?a laptop do ram, cpu, computername. Qua ví d? này, ta có th? m? r?ng vi?c l?y d? li?u th?c qua Emulated Sensor. Gi? s? ta có N sensor g?i N di?m d? li?u. Trên gateway, 1 Emulated Sensor s? thu th?p t?t c? d? li?u thành 1 d?nh d?ng. Ví d? trong phòng có 3 sensor nhi?t d?, 1 sensor báo cháy, 1 sensor d? ?m. T?t c? các sensor này du?c truy?n qua Emulated Sensor thành 4 di?m d? li?u, bi?u th? di?u ki?n hi?n t?i c?a phòng.
## 2.4. Output adaptor: 
### 2.4.1.ConsolePlatform
	D? li?u th?c c?a sensor du?c nh?p tr?c ti?p t? bàn phím, sau dó du?c in ra màn hình console
### 2.4.2.Sparkfun Platform
	Link url: https://data.sparkfun.com/ 
D? li?u d?c t? sensor du?c g?i lên IoT platform sparkfun thông qua Sparkfun APIs
### 2.4.3. Thingspeak
	Link url: https://thingspeak.com/ 
D? li?u d?c t? sensor du?c g?i lên IoT platform thingspeak thông qua Thingspeak APIs
## 2.5. Usage
### 2.5.1.C?u hình cho Emulated sensor thông qua 1 file c?u hình duy nh?t  “sensor.conf” 
C?u hình trong file configure don gi?n, rõ ràng và linh ho?t
a.Configure cho sensor
*rate:
user còn có th? upload d? li?u t? emulated sensor lên các d?u ra liên t?c, th?i gian gi?a các l?n upload cung du?c setting ? trong sensor.conf, thông qua tham s? “rate” (ex: rate = 5000)
*sensorID:
b.Configure cho Input: C?u hình d?nh d?ng cho data d?u vào c?a Emulated Sensor
CSV file: data: data=teit.sensor.CSVFile.CSVDataAdaptor 
D? li?u nh?p t? bàn phím: data=teit.sensor.PlatformConsole.ConsoleData
Customer data: 
data=teit.sensor.PlatformSparkFun.LaptopData (Sparkfun platform)
data=teit.sensor.PlatformThingSpeak.ThingSpeakData (Thingspeak platform)

c.Configure cho Output: C?u hình noi Emulated Sensor  g?i d? li?u t?i
Console Platform: platform=teit.sensor.PlatformConsole.ConsolePlatform
Thingspeak Platform: platform=teit.sensor.PlatformThingSpeak.ThingSpeakPlatform
Sparkfun Platform: platform=teit.sensor.PlatformSparkFun.SparkfunPlatform
MQTT: platform=teit.sensor.MQTT.MQTTOutput 
		
### 2.5.2. Run Emulated sensor:
Sau khi chu?n b? d? li?u và c?u hình trong sensor.conf
Trong command line, gõ dòng l?nh sau d? ch?y:

java -jar target\EmulatedSensor-1.0-SNAPSHOT.jar 

